# DeepSeek OCR - 离线部署指南

## 问题说明

当分发到无法访问 huggingface.co 的电脑时，模型加载会失败。

## 解决方案：创建离线模型包

### 步骤 1：在有网络的电脑上下载模型

```python
# download_model.py
from transformers import AutoModel, AutoTokenizer

model_name = "deepseek-ai/DeepSeek-OCR"
save_path = "./models/DeepSeek-OCR"

print("正在下载模型...")
tokenizer = AutoTokenizer.from_pretrained(model_name, trust_remote_code=True)
model = AutoModel.from_pretrained(model_name, trust_remote_code=True)

print(f"保存模型到: {save_path}")
tokenizer.save_pretrained(save_path)
model.save_pretrained(save_path)

print("✓ 模型下载完成！")
```

运行下载：
```bash
python download_model.py
```

### 步骤 2：打包模型文件

下载完成后，`models/DeepSeek-OCR` 文件夹包含：
```
models/DeepSeek-OCR/
├── config.json
├── tokenizer_config.json
├── tokenizer.json
├── special_tokens_map.json
├── model.safetensors (或 pytorch_model.bin)
├── 以及其他模型文件
```

### 步骤 3：分发完整包

**完整分发包结构：**
```
DeepSeekOCR_Offline/
├── DeepSeekOCR.exe           # 主程序
├── _internal/                 # 依赖文件
├── models/                    # 模型文件夹
│   └── DeepSeek-OCR/         # 完整的模型文件
│       ├── config.json
│       ├── tokenizer_config.json
│       ├── model.safetensors
│       └── ...
├── 用户手册.txt
└── 启动.bat
```

### 步骤 4：修改程序使用本地模型

在 GUI 中，模型路径改为：
```
./models/DeepSeek-OCR
```

---

## 方案对比

| 方案 | 优点 | 缺点 | 适用场景 |
|------|------|------|----------|
| **离线模型包** | 无需网络，一键使用 | 体积大（5-10GB） | 内部分发、无外网环境 |
| **配置镜像站** | 体积小 | 需要配置，依赖镜像 | 有网但访问慢 |
| **VPN/代理** | 无需修改 | 需要代理工具 | 临时解决 |

---

## 详细操作步骤

### 一、准备离线模型包

#### 1. 在您的电脑（有网）上运行
